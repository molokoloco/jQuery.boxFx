(function(){function l(a){return a.replace(/<[^>]*>?/gi,m)}function m(a){return a.match(n)||a.match(o)||a.match(p)?a:""}function q(a){if(""==a)return"";var d=/<\/?\w+[^>]*(\s|$|>)/g,f=a.toLowerCase().match(d),e=(f||[]).length;if(0==e)return a;for(var h,c,g,i=[],j=[],k=!1,b=0;b<e;b++)if(h=f[b].replace(/<\/?(\w+).*/,"$1"),!(i[b]||-1<"<p><img><br><li><hr>".search("<"+h+">"))){c=f[b];g=-1;if(!/^<\//.test(c))for(c=b+1;c<e;c++)if(!i[c]&&f[c]=="</"+h+">"){g=c;break}-1==g?k=j[b]=!0:i[g]=!0}if(!k)return a;
b=0;return a=a.replace(d,function(a){a=j[b]?"":a;b++;return a})}var d,e;"object"===typeof exports&&"function"===typeof require?(d=exports,e=require("./Markdown.Converter").Converter):(d=window.Markdown,e=d.Converter);d.getSanitizingConverter=function(){var a=new e;a.hooks.chain("postConversion",l);a.hooks.chain("postConversion",q);return a};var n=/^(<\/?(b|blockquote|code|del|dd|dl|dt|em|h1|h2|h3|i|kbd|li|ol|p|pre|s|sup|sub|strong|strike|ul)>|<(br|hr)\s?\/?>)$/i,o=/^(<a\shref="((https?|ftp):\/\/|\/)[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)]+"(\stitle="[^"<>]+")?\s?>|<\/a>)$/i,
p=/^(<img\ssrc="(https?:\/\/|\/)[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)]+"(\swidth="\d{1,3}")?(\sheight="\d{1,3}")?(\salt="[^"<>]*")?(\stitle="[^"<>]*")?\s?\/?>)$/i})();